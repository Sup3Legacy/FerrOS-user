#![no_std]
#![feature(start)]
#![no_main]

use ferr_os_librust::{io, syscall};
extern crate alloc;

use alloc::string::String;

#[no_mangle]
pub extern "C" fn _start(heap_address: u64, heap_size: u64, _args: u64, _args_number: u64) {
    ferr_os_librust::allocator::init(heap_address, heap_size);
    main();
}

static mut SOUND_FD: u64 = 0_u64;

macro_rules! play {
    // freq [Hz], duration [1/36 sec], offset [1/36 sec]
    ( $( ($f: literal , $d: literal , $o: literal ) );* ) => {
        $(
            {
                io::push_sound(SOUND_FD, $f, $d, $o);
            }
        )*
    };
}

#[inline(never)]
fn main() {
    unsafe {
        SOUND_FD = syscall::open(&String::from("/hard/sound"), io::OpenFlags::OWR) as u64;
        // Sound generated by haskell music.
        play!(
            (98, 4, 0);
            (98, 4, 4);
            (196, 4, 8);
            (98, 4, 13);
            (98, 4, 17);
            (196, 4, 21);
            (98, 4, 25);
            (98, 4, 30);
            (185, 4, 34);
            (98, 4, 38);
            (98, 4, 42);
            (165, 4, 47);
            (98, 4, 51);
            (98, 4, 55);
            (139, 4, 59);
            (98, 4, 64);
            (98, 4, 68);
            (147, 4, 72);
            (165, 4, 76);
            (98, 4, 80);
            (98, 4, 85);
            (196, 4, 89);
            (98, 4, 93);
            (98, 4, 97);
            (185, 4, 102);
            (98, 4, 106);
            (98, 4, 110);
            (233, 3, 114);
            (185, 3, 117);
            (147, 3, 120);
            (262, 3, 123);
            (220, 3, 126);
            (147, 3, 128);
            (185, 3, 131);
            (220, 3, 134);
            (262, 3, 137);
            (220, 3, 140);
            (185, 3, 143);
            (147, 3, 145);
            (98, 4, 148);
            (98, 4, 152);
            (196, 4, 157);
            (98, 4, 161);
            (98, 4, 165);
            (185, 4, 169);
            (98, 4, 174);
            (98, 4, 178);
            (165, 4, 182);
            (98, 4, 186);
            (98, 4, 191);
            (139, 4, 195);
            (98, 4, 199);
            (98, 4, 203);
            (147, 4, 208);
            (165, 4, 212);
            (98, 4, 216);
            (98, 4, 220);
            (196, 4, 224);
            (98, 4, 229);
            (98, 4, 233);
            (185, 4, 237);
            (98, 4, 241);
            (98, 4, 246);
            (165, 4, 250);
            (98, 4, 254);
            (98, 4, 258);
            (139, 21, 263);
            (98, 4, 284);
            (98, 4, 288);
            (196, 4, 292);
            (98, 4, 296);
            (98, 4, 301);
            (185, 4, 305);
            (98, 4, 309);
            (98, 4, 313);
            (165, 4, 318);
            (98, 4, 322);
            (98, 4, 326);
            (139, 4, 330);
            (98, 4, 335);
            (98, 4, 339);
            (147, 4, 343);
            (165, 4, 347);
            (98, 4, 352);
            (98, 4, 356);
            (196, 4, 360);
            (98, 4, 364);
            (98, 4, 368);
            (185, 4, 373);
            (98, 4, 377);
            (98, 4, 381);
            (294, 3, 385);
            (247, 3, 388);
            (196, 3, 391);
            (247, 3, 394);
            (294, 3, 397);
            (392, 3, 400);
            (247, 3, 402);
            (294, 3, 405);
            (392, 3, 408);
            (294, 3, 411);
            (494, 3, 414);
            (587, 3, 416);
            (131, 4, 419);
            (131, 4, 424);
            (262, 4, 428);
            (131, 4, 432);
            (131, 4, 436);
            (247, 4, 440);
            (131, 4, 445);
            (131, 4, 449);
            (220, 4, 453);
            (131, 4, 457);
            (131, 4, 462);
            (98, 4, 466);
            (131, 4, 470);
            (131, 4, 474);
            (196, 4, 479);
            (220, 4, 483);
            (131, 4, 487);
            (131, 4, 491);
            (262, 4, 496);
            (131, 4, 500);
            (131, 4, 504);
            (247, 4, 508);
            (131, 4, 512);
            (131, 4, 517);
            (220, 4, 521);
            (131, 4, 525);
            (131, 4, 529);
            (98, 21, 534);
            (131, 4, 555);
            (131, 4, 559);
            (262, 4, 563);
            (131, 4, 568);
            (131, 4, 572);
            (247, 4, 576);
            (131, 4, 580);
            (131, 4, 584);
            (220, 4, 589);
            (131, 4, 593);
            (131, 4, 597);
            (98, 4, 601);
            (131, 4, 606);
            (131, 4, 610);
            (196, 4, 614);
            (220, 4, 618);
            (131, 4, 623);
            (131, 4, 627);
            (262, 4, 631);
            (131, 4, 635);
            (131, 4, 640);
            (247, 4, 644);
            (131, 4, 648);
            (131, 4, 652);
            (262, 3, 656);
            (220, 3, 659);
            (185, 3, 662);
            (262, 3, 665);
            (220, 3, 668);
            (185, 3, 671);
            (330, 3, 673);
            (262, 3, 676);
            (220, 3, 679);
            (262, 3, 682);
            (220, 3, 685);
            (185, 3, 688);
            (98, 4, 690);
            (98, 4, 695);
            (175, 4, 699);
            (175, 4, 703);
            (349, 4, 707);
            (175, 4, 712);
            (175, 4, 716);
            (294, 4, 720);
            (175, 4, 724);
            (175, 4, 728);
            (262, 4, 733);
            (175, 4, 737);
            (175, 4, 741);
            (247, 4, 745);
            (175, 4, 750);
            (175, 4, 754);
            (262, 4, 758);
            (262, 4, 762);
            (147, 4, 767);
            (147, 4, 771);
            (294, 4, 775);
            (147, 4, 779);
            (147, 4, 784);
            (262, 4, 788);
            (147, 4, 792);
            (147, 4, 796);
            (247, 4, 800);
            (131, 4, 805);
            (131, 4, 809);
            (220, 21, 813);
            (98, 4, 834);
            (98, 4, 839);
            (196, 4, 843);
            (98, 4, 847);
            (98, 4, 851);
            (185, 4, 856);
            (98, 4, 860);
            (98, 4, 864);
            (165, 4, 868);
            (98, 4, 872);
            (98, 4, 877);
            (139, 4, 881);
            (98, 4, 885);
            (98, 4, 889);
            (147, 4, 894);
            (165, 4, 898);
            (98, 4, 902);
            (98, 4, 906);
            (196, 4, 911);
            (98, 4, 915);
            (98, 4, 919);
            (185, 4, 923);
            (98, 4, 928);
            (98, 4, 932);
            (294, 3, 936);
            (247, 3, 939);
            (196, 3, 942);
            (247, 3, 944);
            (294, 3, 947);
            (392, 3, 950);
            (247, 3, 953);
            (294, 3, 956);
            (392, 3, 959);
            (294, 3, 961);
            (392, 3, 964);
            (494, 3, 967);
            (98, 4, 970);
            (98, 4, 974);
            (196, 4, 978);
            (98, 4, 983);
            (98, 4, 987);
            (185, 4, 991);
            (98, 4, 995);
            (98, 4, 1000);
            (165, 4, 1004);
            (98, 4, 1008);
            (98, 4, 1012);
            (139, 4, 1016);
            (98, 4, 1021);
            (98, 4, 1025);
            (147, 4, 1029);
            (165, 4, 1033);
            (98, 4, 1038);
            (98, 4, 1042);
            (196, 4, 1046);
            (98, 4, 1050);
            (98, 4, 1055);
            (185, 4, 1059);
            (98, 4, 1063);
            (98, 4, 1067);
            (165, 4, 1072);
            (98, 4, 1076);
            (98, 4, 1080);
            (139, 21, 1084);
            (98, 4, 1105);
            (98, 4, 1110);
            (196, 4, 1114);
            (98, 4, 1118);
            (98, 4, 1122);
            (185, 4, 1127);
            (98, 4, 1131);
            (98, 4, 1135);
            (165, 4, 1139);
            (98, 4, 1144);
            (98, 4, 1148);
            (139, 4, 1152);
            (98, 4, 1156);
            (98, 4, 1160);
            (147, 4, 1165);
            (165, 4, 1169);
            (98, 4, 1173);
            (98, 4, 1177);
            (196, 4, 1182);
            (98, 4, 1186);
            (98, 4, 1190);
            (185, 4, 1194);
            (98, 4, 1199);
            (98, 4, 1203);
            (233, 3, 1207);
            (196, 3, 1210);
            (147, 3, 1213);
            (220, 3, 1216);
            (185, 3, 1218);
            (147, 3, 1221);
            (294, 3, 1224);
            (185, 3, 1227);
            (147, 3, 1230);
            (392, 3, 1232);
            (185, 3, 1235);
            (147, 3, 1238);
            (98, 4, 1241);
            (98, 4, 1245);
            (196, 4, 1249);
            (98, 4, 1254);
            (98, 4, 1258);
            (185, 4, 1262);
            (98, 4, 1266);
            (98, 4, 1271);
            (165, 4, 1275);
            (98, 4, 1279);
            (98, 4, 1283);
            (139, 4, 1288);
            (98, 4, 1292);
            (98, 4, 1296);
            (147, 4, 1300);
            (165, 4, 1304);
            (98, 4, 1309);
            (98, 4, 1313);
            (196, 4, 1317);
            (98, 4, 1321);
            (98, 4, 1326);
            (185, 4, 1330);
            (98, 4, 1334);
            (98, 4, 1338);
            (165, 4, 1343);
            (98, 4, 1347);
            (98, 4, 1351);
            (139, 21, 1355);
            (98, 4, 1376);
            (98, 4, 1381);
            (196, 4, 1385);
            (98, 4, 1389);
            (98, 4, 1393);
            (185, 4, 1398);
            (98, 4, 1402);
            (98, 4, 1406);
            (165, 4, 1410);
            (98, 4, 1415);
            (98, 4, 1419);
            (139, 4, 1423);
            (98, 4, 1427);
            (98, 4, 1432);
            (147, 4, 1436);
            (165, 4, 1440);
            (98, 4, 1444);
            (98, 4, 1448);
            (196, 4, 1453);
            (98, 4, 1457);
            (98, 4, 1461);
            (185, 4, 1465);
            (98, 4, 1470);
            (98, 4, 1474);
            (392, 3, 1478);
            (294, 3, 1481);
            (247, 3, 1484);
            (494, 3, 1487);
            (392, 3, 1489);
            (247, 3, 1492);
            (294, 3, 1495);
            (370, 3, 1498);
            (392, 3, 1501);
            (494, 3, 1504);
            (392, 3, 1506);
            (247, 3, 1509);
            (131, 4, 1512);
            (131, 4, 1516);
            (262, 4, 1520);
            (131, 4, 1525);
            (131, 4, 1529);
            (247, 4, 1533);
            (131, 4, 1537);
            (131, 4, 1542);
            (220, 4, 1546);
            (131, 4, 1550);
            (131, 4, 1554);
            (98, 4, 1559);
            (131, 4, 1563);
            (131, 4, 1567);
            (196, 4, 1571);
            (220, 4, 1576);
            (131, 4, 1580);
            (131, 4, 1584);
            (262, 4, 1588);
            (131, 4, 1592);
            (131, 4, 1597);
            (247, 4, 1601);
            (131, 4, 1605);
            (131, 4, 1609);
            (220, 4, 1614);
            (131, 4, 1618);
            (131, 4, 1622);
            (98, 21, 1626);
            (131, 4, 1648);
            (131, 4, 1652);
            (262, 4, 1656);
            (131, 4, 1660);
            (131, 4, 1664);
            (247, 4, 1669);
            (131, 4, 1673);
            (131, 4, 1677);
            (220, 4, 1681);
            (131, 4, 1686);
            (131, 4, 1690);
            (98, 4, 1694);
            (131, 4, 1698);
            (131, 4, 1703);
            (196, 4, 1707);
            (220, 4, 1711);
            (131, 4, 1715);
            (131, 4, 1720);
            (262, 4, 1724);
            (131, 4, 1728);
            (131, 4, 1732);
            (247, 4, 1736);
            (131, 4, 1741);
            (131, 4, 1745);
            (262, 3, 1749);
            (220, 3, 1752);
            (185, 3, 1755);
            (262, 3, 1758);
            (220, 3, 1760);
            (185, 3, 1763);
            (330, 3, 1766);
            (262, 3, 1769);
            (147, 3, 1772);
            (262, 3, 1775);
            (220, 3, 1777);
            (185, 3, 1780);
            (98, 4, 1783);
            (98, 4, 1787);
            (175, 4, 1792);
            (175, 4, 1796);
            (349, 4, 1800);
            (175, 4, 1804);
            (175, 4, 1808);
            (294, 4, 1813);
            (175, 4, 1817);
            (175, 4, 1821);
            (262, 4, 1825);
            (175, 4, 1830);
            (175, 4, 1834);
            (247, 4, 1838);
            (175, 4, 1842);
            (175, 4, 1847);
            (262, 4, 1851);
            (262, 4, 1855);
            (147, 4, 1859);
            (147, 4, 1864);
            (294, 4, 1868);
            (147, 4, 1872);
            (147, 4, 1876);
            (262, 4, 1880);
            (147, 4, 1885);
            (147, 4, 1889);
            (247, 4, 1893);
            (131, 4, 1897);
            (131, 4, 1902);
            (220, 21, 1906);
            (98, 4, 1927);
            (98, 4, 1931);
            (196, 4, 1936);
            (98, 4, 1940);
            (98, 4, 1944);
            (185, 4, 1948);
            (98, 4, 1952);
            (98, 4, 1957);
            (165, 4, 1961);
            (98, 4, 1965);
            (98, 4, 1969);
            (139, 4, 1974);
            (98, 4, 1978);
            (98, 4, 1982);
            (147, 4, 1986);
            (165, 4, 1991);
            (98, 4, 1995);
            (98, 4, 1999);
            (196, 4, 2003);
            (98, 4, 2008);
            (98, 4, 2012);
            (185, 4, 2016);
            (98, 4, 2020);
            (98, 4, 2024);
            (294, 3, 2029);
            (247, 3, 2032);
            (196, 3, 2034);
            (147, 3, 2037);
            (196, 3, 2040);
            (247, 3, 2043);
            (740, 3, 2046);
            (294, 3, 2048);
            (247, 3, 2051);
            (294, 3, 2054);
            (247, 3, 2057);
            (196, 3, 2060)
        );
    }
}
